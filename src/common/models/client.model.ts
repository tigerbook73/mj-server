import { UserModel } from "./user.model";

export interface ClientCreateDto {
  id: string;
  socket: unknown;
}

/**
 * Represents a user in the system.
 */
export class ClientModel {
  constructor(
    public id: string, // unique id generated by server
    public socket: any, // web socket object
    public user: UserModel | null = null, // user information if login
  ) {}

  static create(clientCreate: ClientCreateDto): ClientModel {
    const client = new ClientModel(clientCreate.id, clientCreate.socket, null);
    return client;
  }

  // only for client side
  static fromJSON(data: any): ClientModel {
    const client = new ClientModel(
      data.id,
      data.socket,
      new UserModel(data.user),
    );
    return client;
  }

  toJSON() {
    return {
      id: this.id,
      user: this.user,
      socket: this.socket ? "_" : undefined,
    };
  }
}
